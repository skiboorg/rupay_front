"use strict";(self["webpackChunkrupay_front"]=self["webpackChunkrupay_front"]||[]).push([[5726],{90664:(e,a,l)=>{l.d(a,{Z:()=>h});var t=l(59835),s=l(60499),u=l(43463),n=l(87270),d=l(13433),o=l(17779);const i=({hash:e,password:a})=>{try{const l=d.createDecipher("aes192",a),t=l.update(e,"hex","utf8")+l.final("utf8"),s=JSON.parse(t);return!!s.status&&s.seed}catch(l){return o.log(l),!1}};var c=l(17779);const r={props:["transactionInfo"]},m=Object.assign(r,{name:"PinCodeModal",emits:["pincode_ок"],setup(e,{emit:a}){const l=(0,u.s)();function d(e){const t=localStorage.getItem("hash"),s=i({hash:t,password:e});c.log(s),s?(a("pincode_ок"),l.togglePinCodeModalVisible()):(0,n.d)("negative","Неверный пинкод")}return(e,a)=>{const u=(0,t.up)("pin-code"),n=(0,t.up)("q-btn"),o=(0,t.up)("q-card-section"),i=(0,t.up)("q-card"),c=(0,t.up)("q-dialog");return(0,t.wg)(),(0,t.j4)(c,{modelValue:(0,s.SU)(l).pinCodeModalVisible,"onUpdate:modelValue":a[1]||(a[1]=e=>(0,s.SU)(l).pinCodeModalVisible=e),persistent:"",maximized:""},{default:(0,t.w5)((()=>[(0,t.Wm)(i,{class:"bg-white fullscreen"},{default:(0,t.w5)((()=>[(0,t.Wm)(o,{class:"flex column items-center justify-center fullscreen"},{default:(0,t.w5)((()=>[(0,t.Wm)(u,{showDigits:!1,onPincode_ready:d}),(0,t.Wm)(n,{class:"q-mt-md",onClick:a[0]||(a[0]=e=>(0,s.SU)(l).togglePinCodeModalVisible()),"no-caps":"",color:"negative",label:"Отмена"})])),_:1})])),_:1})])),_:1},8,["modelValue"])}}});var p=l(32074),v=l(44458),w=l(63190),g=l(24455),f=l(69984),b=l.n(f);const _=m,h=_;b()(m,"components",{QDialog:p.Z,QCard:v.Z,QCardSection:w.Z,QBtn:g.Z})},25726:(e,a,l)=>{l.r(a),l.d(a,{default:()=>G});var t=l(59835),s=l(86970),u=l(60499),n=l(91569),d=l(90664),o=l(43463),i=l(87270),c=l(18910),r=l(98030),m=l(46190),p=l(23459),v=l(17779);const w=(0,t._)("div",{style:{height:"16px"}},null,-1),g=(0,t.Uk)("Ваш баланс"),f=(0,t.Uk)("Количество отправляемых взносов "),b={class:"text-bold"},_=(0,t._)("p",{class:"text-bold text-caption text-center text-negative q-mb-none"},"ВНИМАНИЕ ВЫ СОВЕРШАЕТЕ НЕВОЗВРАТНЫЙ ВЗНОС",-1),h=(0,t.Uk)(" Подтверждение отправки актива "),W=(0,t.Uk)("Актив"),k=(0,t.Uk)("OLF"),x=(0,t.Uk)("Количество"),q=(0,t.Uk)("Комиссия транзакции"),y={key:0},U={key:1},Z={name:"Buy_part",setup(e){const a=(0,o.s)(),{EraChain:Z}=((0,c.tv)(),l(99407)),C=(0,m.c)(),V=(0,p.Q)(),Q=(0,u.iH)({label:"250 OLF",value:250}),S=(0,u.iH)([{label:"250 OLF",value:250},{label:"25 OLF",value:25}]);let F=(0,u.iH)(!1);const H=(0,u.iH)(!1),L=(0,u.iH)(0),O=(0,u.iH)(!1),M=(0,c.yj)();let P=(0,u.iH)(null);const j=(0,t.Fl)((()=>C.balances)),z=(0,t.Fl)((()=>(N.value.amount=L.value*Q.value.value,L.value*Q.value.value))),D=(0,t.Fl)((()=>Q.value.value+.01*Q.value.value+.002)),I=(0,t.Fl)((()=>{let e;return e=parseInt(j.value[2][0][1]/D.value),L.value=e>0?1:0,e})),A=(0,t.Fl)((()=>C.addresses[C.currentAddressIdx].address));function B(){a.togglePinCodeModalVisible()}(0,t.bv)((async()=>{P.value=M.params.asset_key}));const N=(0,u.iH)({amount:null,address:"7GMmxFHoXhrTM4vbZyRAFsZ2hGtfbqkyhU",title:"Покупка невозвратного паевого взноса",message:"",encrypted:!1,fee:0,raw:0});function G(){N.value={amount:null,address:"7NBHJjDugvtNq9GsMMcwcbx7yNMAn47fLH",title:"Покупка невозвратного паевого взноса",message:"",encrypted:!1,fee:0,raw:0}}async function K(){H.value=!H.value;const e=!0,a=await V.getKeyPair(),l=new Z.Type.KeyPair(a),t={assetKey:"2",amount:N.value.amount};v.log(l),v.log(t);const s=await r.era.tranRawSendAsset(l,t,N.value.address,N.value.title,`Приобретено ${L.value} долей`,N.value.encrypted,e);v.log(s),s.error?(0,i.d)("negative",s.error.message):(N.value.fee=s.fee,N.value.raw=s.raw),H.value=!H.value}async function J(){H.value=!H.value;const e=await n.h.get(`/api/user/check_address?wallet=${A.value}`);if(e.data.success){(0,i.d)("positive",e.data.message);const a=await r.era.broadcast64(N.value.raw);if(v.log(a),a.error)(0,i.d)("negative",a.message);else{(0,i.d)("info","Транзакция создана"),F.value=!1;const e=await n.h.post("/api/user/addition_balance",{wallet:A.value,tx:a.signature,parts:L.value,part_price:Q.value.value});e.data.success?((0,i.d)("positive",e.data.message),O.value=!1,L.value=0):(0,i.d)("negative",e.data.message)}}else(0,i.d)("negative",e.data.message);H.value=!H.value}return(e,a)=>{const l=(0,t.up)("page-header"),n=(0,t.up)("q-item-section"),o=(0,t.up)("q-item"),i=(0,t.up)("q-select"),c=(0,t.up)("q-slider"),r=(0,t.up)("q-separator"),m=(0,t.up)("q-checkbox"),p=(0,t.up)("btn"),v=(0,t.up)("q-list"),Z=(0,t.up)("q-card-section"),C=(0,t.up)("q-btn"),V=(0,t.up)("q-card-actions"),M=(0,t.up)("q-card"),P=(0,t.up)("q-dialog"),A=(0,t.up)("q-page"),R=(0,t.Q2)("close-popup");return(0,t.wg)(),(0,t.j4)(A,null,{default:(0,t.w5)((()=>[(0,t.Wm)(l),w,(0,t.Wm)(Z,{class:"q-pt-none"},{default:(0,t.w5)((()=>[(0,t.Wm)(v,null,{default:(0,t.w5)((()=>[(0,t.Wm)(o,{class:"no-padding"},{default:(0,t.w5)((()=>[(0,t.Wm)(n,{side:"",class:"text-weight-bold text-dark"},{default:(0,t.w5)((()=>[g])),_:1}),(0,t.Wm)(n,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,s.zw)((0,u.SU)(j)[2][0][1])+" OLF",1)])),_:1})])),_:1}),(0,t.Wm)(o,{class:"no-padding"},{default:(0,t.w5)((()=>[(0,t.Wm)(n,{class:"text-weight-bold text-dark"},{default:(0,t.w5)((()=>[(0,t.Wm)(i,{modelValue:Q.value,"onUpdate:modelValue":a[0]||(a[0]=e=>Q.value=e),options:S.value,outlined:"",rounded:"",label:"Выберите стоимость одного невозвратного паевого взноса без учета комиссии"},null,8,["modelValue","options"])])),_:1})])),_:1}),(0,t.Wm)(o,{class:"no-padding"},{default:(0,t.w5)((()=>[(0,t.Wm)(n,{side:"",class:"text-weight-bold text-negative"},{default:(0,t.w5)((()=>[(0,t.Uk)("Стоимость одного невозвратного паевого взноса с учетом комиссии сети "+(0,s.zw)((0,u.SU)(D))+" OLF",1)])),_:1})])),_:1}),(0,t.Wm)(o,{class:"no-padding"},{default:(0,t.w5)((()=>[(0,t.Wm)(n,{class:"text-weight-medium text-dark"},{default:(0,t.w5)((()=>[f,(0,t._)("span",b,(0,s.zw)(L.value)+" ("+(0,s.zw)((0,u.SU)(z))+" OLF)",1)])),_:1})])),_:1}),(0,t.Wm)(o,{class:"no-padding"},{default:(0,t.w5)((()=>[(0,t.Wm)(n,null,{default:(0,t.w5)((()=>[(0,t.Wm)(c,{modelValue:L.value,"onUpdate:modelValue":a[1]||(a[1]=e=>L.value=e),"marker-labels":"",min:(0,u.SU)(I)>0?1:0,max:(0,u.SU)(I)},null,8,["modelValue","min","max"])])),_:1})])),_:1}),(0,t.Wm)(r,{class:"q-my-md"}),_,(0,t.Wm)(m,{class:"q-mb-md",modelValue:O.value,"onUpdate:modelValue":a[2]||(a[2]=e=>O.value=e),label:"Принимаю"},null,8,["modelValue"]),(0,t.Wm)(p,{label:"Отправить",onClick:B,disabled:!(O.value&&L.value>0),outline:!1},null,8,["disabled"])])),_:1})])),_:1}),(0,t.Wm)(P,{modelValue:(0,u.SU)(F),"onUpdate:modelValue":a[3]||(a[3]=e=>(0,u.dq)(F)?F.value=e:F=e),persistent:"","transition-show":"scale","transition-hide":"scale",onBeforeHide:G},{default:(0,t.w5)((()=>[(0,t.Wm)(M,{class:"bg-white text-dark",style:{width:"100%"}},{default:(0,t.w5)((()=>[(0,t.Wm)(Z,{class:"text-weight-bold"},{default:(0,t.w5)((()=>[h])),_:1}),(0,t.Wm)(Z,{class:"q-py-none"},{default:(0,t.w5)((()=>[(0,t.Wm)(v,{dense:"",separator:"",class:"q-mb-md"},{default:(0,t.w5)((()=>[(0,t.Wm)(o,{class:"no-padding"},{default:(0,t.w5)((()=>[(0,t.Wm)(n,{side:"",class:"text-weight-medium text-dark"},{default:(0,t.w5)((()=>[W])),_:1}),(0,t.Wm)(n,null,{default:(0,t.w5)((()=>[k])),_:1})])),_:1}),(0,t.Wm)(o,{class:"no-padding"},{default:(0,t.w5)((()=>[(0,t.Wm)(n,{side:"",class:"text-weight-medium text-dark"},{default:(0,t.w5)((()=>[x])),_:1}),(0,t.Wm)(n,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,s.zw)(N.value.amount)+" OLF",1)])),_:1})])),_:1}),(0,t.Wm)(o,{class:"no-padding"},{default:(0,t.w5)((()=>[(0,t.Wm)(n,{side:"",class:"text-weight-medium text-dark"},{default:(0,t.w5)((()=>[q])),_:1}),(0,t.Wm)(n,{class:"text-caption"},{default:(0,t.w5)((()=>[N.value.fee>0?((0,t.wg)(),(0,t.iD)("span",y,(0,s.zw)(.01*N.value.amount)+" OLF",1)):(0,t.kq)("",!0),N.value.fee>0?((0,t.wg)(),(0,t.iD)("span",U,"+ газ "+(0,s.zw)(N.value.fee)+" OLF",1)):(0,t.kq)("",!0)])),_:1})])),_:1})])),_:1})])),_:1}),(0,t.Wm)(V,{class:"bg-white text-teal"},{default:(0,t.w5)((()=>[0===N.value.fee?((0,t.wg)(),(0,t.j4)(C,{key:0,label:"Расчет комиссии",rounded:"",loading:H.value,class:"q-mb-sm full-width",unelevated:"","no-caps":"",color:"info",onClick:K,outline:!1},null,8,["loading"])):((0,t.wg)(),(0,t.j4)(C,{key:1,label:"Подтвердить",rounded:"",loading:H.value,class:"q-mb-sm full-width",unelevated:"","no-caps":"",color:"positive",onClick:J,outline:!1},null,8,["loading"])),(0,t.wy)((0,t.Wm)(C,{label:"Отменить",rounded:"","no-caps":"",color:"negative",class:"full-width",unelevated:"",outline:"",loading:H.value},null,8,["loading"]),[[R]])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,t.Wm)((0,u.SU)(d.Z),{onPincode_ок:a[4]||(a[4]=e=>(0,u.dq)(F)?F.value=!0:F=!0)})])),_:1})}}};var C=l(69885),V=l(63190),Q=l(13246),S=l(490),F=l(76749),H=l(18401),L=l(28423),O=l(50926),M=l(11221),P=l(32074),j=l(44458),z=l(11821),D=l(24455),I=l(62146),A=l(69984),B=l.n(A);const N=Z,G=N;B()(Z,"components",{QPage:C.Z,QCardSection:V.Z,QList:Q.Z,QItem:S.Z,QItemSection:F.Z,QSelect:H.Z,QSlider:L.Z,QSeparator:O.Z,QCheckbox:M.Z,QDialog:P.Z,QCard:j.Z,QCardActions:z.Z,QBtn:D.Z}),B()(Z,"directives",{ClosePopup:I.Z})}}]);