"use strict";(self["webpackChunkrupay_front"]=self["webpackChunkrupay_front"]||[]).push([[428],{97428:(e,a,l)=>{l.r(a),l.d(a,{default:()=>Ea});l(46727),l(40702),l(18964);var t=l(59835),n=l(60499),u=l(86970),o=l(61957),i=l(76028),s=l(23459),r=l(98030),d=l(91569),c=l(46190),m=l(43463),p=l(6827),v=(l(39981),l(18910)),w=l(66195),g=l.n(w),_=l(82341),f=l.n(_),y=l(95563),x=l.n(y),U=l(17779);const h={class:"flex items-center"},b=["src"],k={class:"no-margin text-weight-medium"},S=(0,t._)("p",{class:"q-mb-none q-px-sm text-weight-medium"},"/",-1),W=["src"],q={class:"no-margin text-weight-medium"},z={class:"row q-col-gutter-md"},H={class:"col-7"},F={class:"row q-col-gutter-sm"},V={class:"col-4"},Q={key:0,class:"no-margin text-bold text-h6"},Z={key:1,class:"no-margin text-bold text-h6 text-positive"},C={class:"col-8"},P={class:"row q-col-gutter-xs text-caption"},j={class:"col-5"},K=(0,t._)("span",{class:"text-grey-7"},"Макс за 24ч",-1),A=(0,t._)("br",null,null,-1),O=(0,t._)("br",null,null,-1),D=(0,t._)("span",{class:"text-grey-7"},"Мин за 24ч",-1),Y=(0,t._)("br",null,null,-1),$={class:"col-6"},I={class:"text-grey-7 ellipsis q-mb-none"},L=(0,t._)("br",null,null,-1),T={class:"text-grey-7 ellipsis q-mb-none"},B=(0,t._)("br",null,null,-1),N={class:"flex items-center no-wrap q-mb-md"},M=(0,t._)("br",null,null,-1),E=(0,t._)("br",null,null,-1),R={class:"text-caption q-mb-sm"},G=(0,t._)("p",{class:"text-caption q-mb-sm"},"Цена за единицу",-1),J=(0,t._)("p",{class:"text-caption q-mb-sm"},"Итого",-1),X={class:"col-5"},ee={class:""},ae={class:"row q-col-gutter-sm"},le={class:"col-6"},te={class:"orders-grid"},ne=(0,t._)("div",{class:"flex items-center justify-between"},[(0,t._)("p",{class:"no-margin text-10 text-grey-8 text-weight-medium"},"Цена"),(0,t._)("p",{class:"no-margin text-10 text-grey-8 text-weight-medium"},"Объем")],-1),ue={class:"no-margin price-red-color text-10 text-weight-medium"},oe={class:"no-margin vol-color text-10 text-weight-medium"},ie={class:"col-6"},se={class:"orders-grid"},re=(0,t._)("div",{class:"flex items-center justify-between"},[(0,t._)("p",{class:"no-margin text-10 text-grey-8 text-weight-medium"},"Цена"),(0,t._)("p",{class:"no-margin text-10 text-grey-8 text-weight-medium"},"Объем")],-1),de={class:"no-margin price-green-color text-10 text-weight-medium"},ce={class:"no-margin vol-color text-10 text-weight-medium"},me={class:"col-6"},pe={class:"flex items-center justify-between"},ve=(0,t._)("p",{class:"no-margin text-10 text-grey-8 text-weight-medium"},"Всего",-1),we={class:"no-margin text-10 vol-color text-weight-medium"},ge={class:"col-6"},_e={class:"flex items-center justify-between"},fe=(0,t._)("p",{class:"no-margin text-10 text-grey-8 text-weight-medium"},"Всего",-1),ye={class:"no-margin text-10 vol-color text-weight-medium"},xe={class:"relative-position"},Ue=(0,t.Uk)(" Подтверждение транзакции создании ордера "),he=(0,t.Uk)("Имею"),be=(0,t.Uk)("Хочу"),ke=(0,t.Uk)("Газ");f().setOptions({rangeSelector:{dropdownLabel:["Масштаб"],buttons:[{type:"month",count:1,text:"1м",title:"1 мес"},{type:"month",count:3,text:"3м",title:"3 мес"},{type:"month",count:6,text:"6м",title:"6 мес"},{type:"ytd",text:"СНГ",title:"С начала года"},{type:"year",count:1,text:"1г",title:"1 год"},{type:"all",text:"Все",title:"Показать всё"}]},lang:{shortMonths:["Янв","Фев","Мар","Апр","Май","Июн","Июл","Авг","Сен","Окт","Ноя","Дек"],weekdays:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"]}}),x()(f());const Se={name:"StockChart",components:{VueHighcharts:g()}},We=Object.assign(Se,{props:{tradePair:Object},setup(e){const a=e,l=(0,m.s)(),o=(0,s.Q)(),w=(0,c.c)(),_=((0,v.tv)(),(0,t.Fl)((()=>o.assets)),(0,t.Fl)((()=>w.balances)));let f=(0,n.iH)([]),y=(0,n.iH)([]),x=(0,n.iH)([]),Se=(0,n.iH)({}),We=(0,n.iH)({}),qe=(0,n.iH)("buy"),ze=(0,n.iH)(null),He=(0,n.iH)(null),Fe=(0,n.iH)(null),Ve=(0,n.iH)(!1),Qe=(0,n.iH)(!1),Ze=(0,n.iH)({}),Ce=(0,n.iH)(0),Pe=(0,n.iH)(0),je=(0,n.iH)(0),Ke=(0,n.iH)(0),Ae=(0,n.iH)({}),Oe=(0,n.iH)([]),De=(0,n.iH)(!0),Ye=(0,n.iH)({rangeSelector:{selected:1},title:{text:""},series:[{name:"",data:[]}]});const $e={11:"Недостаточно средств на балансе",66:"Минимальная стоимость ордера 280руб"};function Ie(){U.log(ze.value),ze.value||(Fe.value=null,He.value=null),He.value&&(Fe.value=parseFloat(ze.value*He.value).toFixed(5))}function Le(){Ke.value=0,je.value=0,qe.value="buy",ze.value=null,He.value=null,Fe.value=null,Ye.value.series[0].data=[],Oe.value=[]}function Te(){Ce.value>0&&"sell"===qe.value&&(2===Se.value.key||1048610===Se.value.key)&&(He.value>=Pe.value||(He.value=Pe.value)),ze.value&&(Fe.value=parseFloat(ze.value*He.value).toFixed(5))}function Be(){U.log(Fe.value),He.value&&(ze.value=parseFloat(Fe.value/He.value).toFixed(5))}async function Ne(){const e=await o.getKeyPair(),a="buy"===qe.value?We.value.key:Se.value.key,l="buy"===qe.value?Fe.value:ze.value,t="buy"===qe.value?Se.value.key:We.value.key,n="buy"===qe.value?ze.value:Fe.value;U.log("have",a),U.log("want",t),U.log("haveAmount",l),U.log("wantAmount",n),await r.era.tranRawOrder(e,"name",a,l,t,n,!0).then((e=>{Ze.value=e,U.log(Ze.value),Ve.value=!0}))}async function Me(){Qe.value=!Qe.value;const e=await r.era.broadcast64(Ze.value.raw);U.log(e),e.error?p.Z.create({color:"negative",message:$e[e.error]}):p.Z.create({color:"info",message:"Транзакция отправлена в сеть"}),Ve.value=!1,Qe.value=!Qe.value}function Ee(e){U.log(e),ze.value=e.leftWant,He.value=e.pairPrice,Fe.value=parseFloat(e.pairAmount*e.pairPrice).toFixed(5),qe.value="sell"}function Re(e){ze.value=parseFloat(e.leftHave).toFixed(5),He.value=e.pairPrice,Fe.value=parseFloat(e.pairAmount*e.pairPrice).toFixed(5),qe.value="buy"}async function Ge(){De.value=!0,x.value=[],y.value=[],Se.value=o.assets.find((e=>e.key===a.tradePair["0"])),We.value=o.assets.find((e=>e.key===a.tradePair["1"])),f.value=await(0,i.AU)(a.tradePair["0"],a.tradePair["1"]),Ce.value=parseFloat(We.value.min_trade_price),Pe.value=parseFloat(Se.value.min_trade_price);for(let a of f.value.have){je.value+=parseFloat(a.leftHave);let e=[];e=f.value.have.filter((e=>e.pairPrice===a.pairPrice));let l=0;if(x.value.filter((e=>e.pairPrice===a.pairPrice)).length>0);else{for(let a of e)l+=parseFloat(a.leftHave);e[0].leftHave=l,x.value.push(e[0])}}for(let a of f.value.want){Ke.value+=parseFloat(a.leftWant);let e=[];e=f.value.want.filter((e=>e.pairPrice===a.pairPrice));let l=0;if(y.value.filter((e=>e.pairPrice===a.pairPrice)).length>0);else{for(let a of e)l+=parseFloat(a.leftWant);e[0].leftWant=l,y.value.push(e[0])}}const e=await d.h.get(`/api/settings/volume?q_key=${We.value.key}&b_key=${Se.value.key}`);Ae.value=e.data;const l=await d.h.get(`https://scan.rupay.pro/apiexchange/trades/${Se.value.key}/${We.value.key}`);for(let a of l.data.reverse())Oe.value.push([a.timestamp,a.price]);Ye.value.series[0].data=Oe.value,Ye.value.series[0].name=`${Se.value.name}/${We.value.name}`,De.value=!1}return(0,t.YP)(qe,(e=>{ze.value=null,He.value=null,Fe.value=null})),(e,a)=>{const o=(0,t.up)("q-btn"),i=(0,t.up)("q-avatar"),s=(0,t.up)("q-header"),r=(0,t.up)("q-separator"),d=(0,t.up)("q-input"),c=(0,t.up)("q-linear-progress"),m=(0,t.up)("q-spinner"),p=(0,t.up)("q-inner-loading"),v=(0,t.up)("q-card-section"),w=(0,t.up)("q-card"),f=(0,t.up)("q-dialog"),U=(0,t.up)("q-item-section"),Ce=(0,t.up)("q-item"),Pe=(0,t.up)("q-list"),Oe=(0,t.up)("q-card-actions"),$e=(0,t.Q2)("close-popup");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t.Wm)(f,{modelValue:(0,n.SU)(l).tradeModalVisible,"onUpdate:modelValue":a[6]||(a[6]=e=>(0,n.SU)(l).tradeModalVisible=e),persistent:"",onBeforeShow:Ge,onBeforeHide:Le},{default:(0,t.w5)((()=>[(0,t.Wm)(w,{style:{width:"900px","max-width":"100vw"}},{default:(0,t.w5)((()=>[(0,t.Wm)(s,{style:{position:"unset","padding-right":"8px","padding-left":"0"},reveal:"",class:"text-white q-py-sm items-center flex justify-between"},{default:(0,t.w5)((()=>[(0,t.wy)((0,t.Wm)(o,{label:"Назад","no-caps":"",icon:"las la-angle-left",unelevated:""},null,512),[[$e]]),(0,t._)("div",h,[(0,t.Wm)(i,{size:"30px",class:"q-mr-sm"},{default:(0,t.w5)((()=>[(0,t._)("img",{src:(0,n.SU)(Se).icon,alt:""},null,8,b)])),_:1}),(0,t._)("p",k,(0,u.zw)((0,n.SU)(Se).name),1),S,(0,t.Wm)(i,{size:"30px",class:"q-mr-sm"},{default:(0,t.w5)((()=>[(0,t._)("img",{src:(0,n.SU)(We).icon,alt:""},null,8,W)])),_:1}),(0,t._)("p",q,(0,u.zw)((0,n.SU)(We).name),1)])])),_:1}),(0,t.Wm)(v,{class:"q-pt-none"},{default:(0,t.w5)((()=>[(0,t._)("div",z,[(0,t._)("div",H,[(0,t._)("div",F,[(0,t._)("div",V,["OLF"!==(0,n.SU)(Se).name?((0,t.wg)(),(0,t.iD)("p",Q,(0,u.zw)(parseFloat((0,n.SU)(Ae).last_price).toFixed(4)),1)):((0,t.wg)(),(0,t.iD)("p",Z,(0,u.zw)((0,n.SU)(Se).course),1))]),(0,t._)("div",C,[(0,t._)("div",P,[(0,t._)("div",j,[K,A,(0,t.Uk)(" "+(0,u.zw)(parseFloat((0,n.SU)(Ae).highest_price_24h).toFixed(2)),1),O,D,Y,(0,t.Uk)(" "+(0,u.zw)(parseFloat((0,n.SU)(Ae).lowest_price_24h).toFixed(2)),1)]),(0,t._)("div",$,[(0,t._)("p",I,"Объем за 24ч ("+(0,u.zw)((0,n.SU)(Se).name)+")",1),(0,t.Uk)(" ~"+(0,u.zw)(parseFloat((0,n.SU)(Ae).base_volume_24).toFixed(2)),1),L,(0,t._)("p",T,"Объем за 24ч ("+(0,u.zw)((0,n.SU)(We).name)+")",1),(0,t.Uk)(" ~"+(0,u.zw)(parseFloat((0,n.SU)(Ae).quote_volume_24).toFixed(2)),1),B])])])]),(0,t.Wm)(r,{spaced:"md"}),(0,t._)("div",N,[(0,t.Wm)(o,{unelevated:"","no-caps":"",class:"bye-btn full-width q-py-sm",color:"buy"===(0,n.SU)(qe)?"positive":"grey-5",onClick:a[0]||(a[0]=e=>(0,n.dq)(qe)?qe.value="buy":qe="buy")},{default:(0,t.w5)((()=>[(0,t.Uk)(" Купить "+(0,u.zw)((0,n.SU)(Se).name)+" ",1),M,(0,t.Uk)("за "+(0,u.zw)((0,n.SU)(We).name),1)])),_:1},8,["color"]),(0,t.Wm)(o,{color:"sell"===(0,n.SU)(qe)?"negative":"grey-5",unelevated:"",class:"sell-btn full-width q-py-sm","no-caps":"",onClick:a[1]||(a[1]=e=>(0,n.dq)(qe)?qe.value="sell":qe="sell")},{default:(0,t.w5)((()=>[(0,t.Uk)(" Продать "+(0,u.zw)((0,n.SU)(Se).name)+" ",1),E,(0,t.Uk)("за "+(0,u.zw)((0,n.SU)(We).name),1)])),_:1},8,["color"])]),(0,t._)("p",R,(0,u.zw)("buy"===(0,n.SU)(qe)?"Кол-во к покупке":"Кол-во к продаже"),1),(0,t.Wm)(d,{class:"q-mb-sm",rounded:"",dense:"",outlined:"",modelValue:(0,n.SU)(ze),"onUpdate:modelValue":a[3]||(a[3]=e=>(0,n.dq)(ze)?ze.value=e:ze=e),onKeyup:Ie,type:"number"},{append:(0,t.w5)((()=>["sell"===(0,n.SU)(qe)?((0,t.wg)(),(0,t.j4)(o,{key:0,onClick:a[2]||(a[2]=e=>(0,n.dq)(ze)?ze.value=(0,n.SU)(_)[(0,n.SU)(Se).key][0][1]:ze=(0,n.SU)(_)[(0,n.SU)(Se).key][0][1]),size:"10px",flat:"",rounded:"",label:"Продать все"})):(0,t.kq)("",!0)])),_:1},8,["modelValue"]),G,(0,t.Wm)(d,{class:"q-mb-sm",rounded:"",dense:"",outlined:"",modelValue:(0,n.SU)(He),"onUpdate:modelValue":a[4]||(a[4]=e=>(0,n.dq)(He)?He.value=e:He=e),onBlur:Te,type:"number"},null,8,["modelValue"]),J,(0,t.Wm)(d,{class:"q-mb-md",rounded:"",dense:"",outlined:"",modelValue:(0,n.SU)(Fe),"onUpdate:modelValue":a[5]||(a[5]=e=>(0,n.dq)(Fe)?Fe.value=e:Fe=e),onKeyup:Be,type:"number"},null,8,["modelValue"]),(0,t.Wm)(o,{rounded:"",loading:(0,n.SU)(Qe),label:"buy"===(0,n.SU)(qe)?"Купить":"Продать",color:"buy"===(0,n.SU)(qe)?"positive":"negative",class:"full-width q-mb-md",unelevated:"",size:"18px","no-caps":"",disable:!(0,n.SU)(ze)||!(0,n.SU)(He)||!(0,n.SU)(Fe),onClick:Ne},null,8,["loading","label","color","disable"])]),(0,t._)("div",X,[(0,t._)("div",ee,[(0,t._)("div",ae,[(0,t._)("div",le,[(0,t._)("div",te,[ne,((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)((0,n.SU)(x),((e,a)=>((0,t.wg)(),(0,t.j4)(c,{reverse:"",onClick:a=>Re(e),class:"flex items-center justify-between relative-position sell-pr cursor-pointer",color:"red-2",value:e.leftHave/e.amountHave,size:"20px"},{default:(0,t.w5)((()=>[(0,t._)("p",ue,(0,u.zw)(e.pairPrice),1),(0,t._)("p",oe,(0,u.zw)(e.leftHave),1)])),_:2},1032,["onClick","value"])))),256))])]),(0,t._)("div",ie,[(0,t._)("div",se,[re,((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)((0,n.SU)(y),((e,a)=>((0,t.wg)(),(0,t.j4)(c,{onClick:a=>Ee(e),class:"flex items-center justify-between relative-position bg-white buy-pr cursor-pointer",color:"light-green-11",value:e.leftWant/e.amountWant,size:"20px"},{default:(0,t.w5)((()=>[(0,t._)("p",de,(0,u.zw)(e.pairPrice),1),(0,t._)("p",ce,(0,u.zw)(e.leftWant),1)])),_:2},1032,["onClick","value"])))),256))])]),(0,t._)("div",me,[(0,t.Wm)(r),(0,t._)("div",pe,[ve,(0,t._)("p",we,(0,u.zw)((0,n.SU)(je)),1)])]),(0,t._)("div",ge,[(0,t.Wm)(r),(0,t._)("div",_e,[fe,(0,t._)("p",ye,(0,u.zw)((0,n.SU)(Ke)),1)])])])])])]),(0,t._)("div",xe,[(0,t.Wm)(p,{class:"z-max",showing:(0,n.SU)(De),color:"primary"},{default:(0,t.w5)((()=>[(0,t.Wm)(m,{color:"primary",size:"2em"})])),_:1},8,["showing"]),(0,t.Wm)((0,n.SU)(g()),{style:{width:"100%",overflow:"unset"},type:"stockChart",options:(0,n.SU)(Ye),redrawOnUpdate:!0,oneToOneUpdate:!1,animateOnUpdate:!0},null,8,["options"])])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,t.Wm)(f,{modelValue:(0,n.SU)(Ve),"onUpdate:modelValue":a[7]||(a[7]=e=>(0,n.dq)(Ve)?Ve.value=e:Ve=e),persistent:"","transition-show":"scale","transition-hide":"scale"},{default:(0,t.w5)((()=>[(0,t.Wm)(w,{style:{width:"100%"}},{default:(0,t.w5)((()=>[(0,t.Wm)(v,{class:"bg-primary text-white"},{default:(0,t.w5)((()=>[Ue])),_:1}),(0,t.Wm)(v,null,{default:(0,t.w5)((()=>[(0,t.Wm)(Pe,{separator:"",dense:""},{default:(0,t.w5)((()=>[(0,t.Wm)(Ce,null,{default:(0,t.w5)((()=>[(0,t.Wm)(U,null,{default:(0,t.w5)((()=>[he])),_:1}),(0,t.Wm)(U,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)("buy"===(0,n.SU)(qe)?(0,n.SU)(Fe):(0,n.SU)(ze))+" "+(0,u.zw)("buy"===(0,n.SU)(qe)?(0,n.SU)(We).name:(0,n.SU)(Se).name),1)])),_:1})])),_:1}),(0,t.Wm)(Ce,null,{default:(0,t.w5)((()=>[(0,t.Wm)(U,null,{default:(0,t.w5)((()=>[be])),_:1}),(0,t.Wm)(U,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)("buy"===(0,n.SU)(qe)?(0,n.SU)(ze):(0,n.SU)(Fe))+" "+(0,u.zw)("buy"===(0,n.SU)(qe)?(0,n.SU)(Se).name:(0,n.SU)(We).name),1)])),_:1})])),_:1}),(0,t.Wm)(Ce,null,{default:(0,t.w5)((()=>[(0,t.Wm)(U,null,{default:(0,t.w5)((()=>[ke])),_:1}),(0,t.Wm)(U,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)((0,n.SU)(Ze).fee)+" OLF ",1)])),_:1})])),_:1})])),_:1})])),_:1}),(0,t.Wm)(Oe,{align:"right"},{default:(0,t.w5)((()=>[(0,t.wy)((0,t.Wm)(o,{rounded:"","no-caps":"",unelevated:"",color:"grey-6",loading:(0,n.SU)(Qe),label:"Отмена"},null,8,["loading"]),[[$e]]),(0,t.Wm)(o,{rounded:"","no-caps":"",unelevated:"",loading:(0,n.SU)(Qe),onClick:Me,label:"buy"===(0,n.SU)(qe)?"Купить":"Продать",color:"buy"===(0,n.SU)(qe)?"positive":"negative"},null,8,["loading","label","color"])])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}}});var qe=l(32074),ze=l(44458),He=l(16602),Fe=l(24455),Ve=l(61357),Qe=l(63190),Ze=l(50926),Ce=l(13119),Pe=l(8289),je=l(60854),Ke=l(63940),Ae=l(13246),Oe=l(490),De=l(76749),Ye=l(11821),$e=l(62146),Ie=l(69984),Le=l.n(Ie);const Te=We,Be=Te;Le()(We,"components",{QDialog:qe.Z,QCard:ze.Z,QHeader:He.Z,QBtn:Fe.Z,QAvatar:Ve.Z,QCardSection:Qe.Z,QSeparator:Ze.Z,QInput:Ce.Z,QLinearProgress:Pe.Z,QInnerLoading:je.Z,QSpinner:Ke.Z,QList:Ae.Z,QItem:Oe.Z,QItemSection:De.Z,QCardActions:Ye.Z}),Le()(We,"directives",{ClosePopup:$e.Z});var Ne=l(17779);const Me={class:"flex items-center justify-start"},Ee=["src"],Re=["src"],Ge={class:"q-pa-md"},Je={key:0},Xe=(0,t._)("span",{class:"text-weight-medium text-grey-9"},"за 24ч",-1),ea=(0,t.Uk)(" : "),aa=(0,t._)("br",null,null,-1),la=(0,t._)("span",{class:"text-weight-medium text-grey-9"},"за 7д",-1),ta=(0,t.Uk)(" : "),na=(0,t._)("br",null,null,-1),ua=(0,t._)("span",{class:"text-weight-medium text-grey-9"},"за 1м",-1),oa=(0,t.Uk)(" : "),ia={class:"no-margin text-caption text-weight-bold"},sa={class:"no-margin text-caption"},ra={class:"no-margin text-caption"},da={class:"no-margin text-caption"},ca={class:"no-margin text-caption"},ma={class:"no-margin text-caption"},pa=(0,t.Uk)("Блок "),va=["href"],wa={class:"no-margin text-caption text-weight-bold"},ga={class:"no-margin text-caption"},_a={class:"no-margin text-caption"},fa={class:"no-margin text-caption"},ya={class:"no-margin text-caption"},xa={class:"no-margin text-caption"},Ua=(0,t.Uk)("Блок "),ha=["href"],ba={class:"no-margin text-caption text-weight-bold"},ka={class:"no-margin text-caption"},Sa={class:"no-margin text-caption"},Wa={class:"no-margin text-caption"},qa={class:"no-margin text-caption"},za={class:"no-margin text-caption"},Ha=(0,t.Uk)("Блок "),Fa=["href"],Va={class:"text-h6"},Qa={class:"caption q-mb-sm"},Za={class:"caption q-mb-sm"},Ca={key:0,class:"no-margin text-negative text-center"},Pa=(0,t.Uk)(" Подтверждение транзакции отмены ордера "),ja=(0,t.Uk)("Комиссия"),Ka={components:{TradeModal:Be}},Aa=Object.assign(Ka,{name:"Exchange",setup(e){const a=(0,s.Q)(),l=(0,c.c)(),p=(0,m.s)(),v=(0,n.iH)(null),w=(0,n.iH)(!1),g=(0,n.iH)(!1),_=(0,n.iH)(null),f=(0,n.iH)(null),y=(0,n.iH)("market"),x=(0,n.iH)("active"),U=(0,n.iH)(null),h=(0,n.iH)({}),b=(0,n.iH)([]),k=(0,n.iH)([]),S=(0,n.iH)([]),W=(0,n.iH)([]),q=(0,n.iH)({});let z=(0,n.iH)({}),H=(0,n.iH)(!1),F=(0,n.iH)([]);async function V(e){g.value=!g.value;const l=await a.getKeyPair(),t=await r.era.tranBySeq(e);Ne.log(t);const n=await r.era.tranRawCancelOrder(l,"name",t.signature,!0);z.value=n,Ne.log(z.value),H.value=!0,g.value=!g.value}async function Q(){g.value=!g.value,Ne.log(z.value.raw);const e=await r.era.broadcast64(z.value.raw);Ne.log(e),H.value=!1,g.value=!g.value}function Z(){let e=A.value[v.value];U.value=_.value*e.price}function C(){let e=A.value[v.value];_.value=U.value*e.reversePrice}function P(){_.value=null,U.value=null,z.value={}}async function j(){g.value=!g.value;const e=await a.getKeyPair();let l=A.value[v.value];const t=l.have,n=_.value,u=l.want,o=U.value;Ne.log("have",t),Ne.log("want",u),Ne.log("haveAmount",n),Ne.log("wantAmount",o),await r.era.tranRawOrder(e,"name",t,n,u,o,!0).then((e=>{z.value=e,Ne.log(z.value)})),g.value=!g.value}(0,t.YP)(f,(e=>{if(e){let a={};Ne.log(O.value);let l=Object.keys(O.value).filter((a=>a.toUpperCase().includes(e.toUpperCase())));Ne.log(l);for(let e of l)Ne.log(O.value[e]),a[e]=O.value[e];q.value=a,Ne.log(a)}else q.value={}})),(0,t.YP)(_,(e=>{e>Y.value[A.value[v.value].have][0][1]&&(_.value=Y.value[A.value[v.value].have][0][1],U.value=0,C())}));const K=(0,t.Fl)((()=>a.assets)),A=(0,t.Fl)((()=>a.marketExchange)),O=(0,t.Fl)((()=>a.trade_pairs)),D=(0,t.Fl)((()=>l.addresses[l.currentAddressIdx].address)),Y=((0,t.Fl)((()=>l.assets)),(0,t.Fl)((()=>l.balances))),$=(0,t.Fl)((()=>Object.keys(Y.value)));return(0,t.wF)((async()=>{p.toggleLoadingState();const e=await d.h.get("/api/settings/volumes");Ne.log(e.data),F.value=e.data,await a.getMarketExchangeOrders(),await a.setTradePairs(),b.value=await(0,i.rK)(D.value);let l=[];for(let a of b.value)K.value.find((e=>e.key===a.haveAssetKey))&&K.value.find((e=>e.key===a.wantAssetKey))&&l.push(a);k.value=l.filter((e=>1===e.status||2===e.status)),S.value=l.filter((e=>3===e.status)),W.value=l.filter((e=>4===e.status)),p.toggleLoadingState()})),(e,a)=>{const l=(0,t.up)("page-header"),i=(0,t.up)("q-tab"),s=(0,t.up)("q-tabs"),r=(0,t.up)("q-separator"),d=(0,t.up)("q-avatar"),c=(0,t.up)("q-icon"),m=(0,t.up)("q-item-section"),b=(0,t.up)("q-item-label"),D=(0,t.up)("q-item"),I=(0,t.up)("q-list"),L=(0,t.up)("q-scroll-area"),T=(0,t.up)("q-tab-panel"),B=(0,t.up)("q-input"),N=(0,t.up)("q-badge"),M=(0,t.up)("q-btn"),E=(0,t.up)("q-tab-panels"),R=(0,t.up)("q-card-section"),G=(0,t.up)("q-card-actions"),J=(0,t.up)("q-card"),X=(0,t.up)("q-dialog"),ee=(0,t.up)("page-body"),ae=(0,t.up)("page"),le=(0,t.Q2)("touch-swipe"),te=(0,t.Q2)("close-popup");return(0,t.wg)(),(0,t.j4)(ae,null,{default:(0,t.w5)((()=>[(0,t.Wm)(ee,null,{default:(0,t.w5)((()=>[(0,t.Wm)(l),(0,t.wy)(((0,t.wg)(),(0,t.j4)(s,{modelValue:y.value,"onUpdate:modelValue":a[0]||(a[0]=e=>y.value=e),class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify"},{default:(0,t.w5)((()=>[(0,t.Wm)(i,{"no-caps":"",class:"bg-white",name:"market",label:"Биржа"}),(0,t.Wm)(i,{"no-caps":"",class:"bg-white",name:"own_orders",label:"Мои оффера"})])),_:1},8,["modelValue"])),[[le]]),(0,t.Wm)(r),(0,t.Wm)(E,{modelValue:y.value,"onUpdate:modelValue":a[4]||(a[4]=e=>y.value=e),animated:""},{default:(0,t.w5)((()=>[(0,t.Wm)(T,{name:"exchange",class:"no-padding"},{default:(0,t.w5)((()=>[(0,t.Wm)(L,{style:{height:"85vh"}},{default:(0,t.w5)((()=>[(0,t.Wm)(I,{separator:""},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)((0,n.SU)(A),((e,a)=>(0,t.wy)(((0,t.wg)(),(0,t.j4)(D,{clickable:"",onClick:e=>(v.value=a,w.value=!0),key:a},{default:(0,t.w5)((()=>[(0,t.Wm)(m,null,{default:(0,t.w5)((()=>[(0,t._)("div",Me,[(0,t.Wm)(d,{rounded:""},{default:(0,t.w5)((()=>[(0,t._)("img",{src:`/asset_icons/${(0,n.SU)(K).find((a=>a.key===e.have)).icon}`},null,8,Ee)])),_:2},1024),(0,t.Wm)(c,{name:"las la-long-arrow-alt-right",size:"30px"}),(0,t.Wm)(d,{rounded:""},{default:(0,t.w5)((()=>[(0,t._)("img",{src:`/asset_icons/${(0,n.SU)(K).find((a=>a.key===e.want)).icon}`},null,8,Re)])),_:2},1024)])])),_:2},1024),(0,t.Wm)(m,null,{default:(0,t.w5)((()=>[(0,t.Wm)(b,{class:"text-weight-medium"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)((0,n.SU)(K).find((a=>a.key===e.have)).name)+"/"+(0,u.zw)((0,n.SU)(K).find((a=>a.key===e.want)).name),1)])),_:2},1024),(0,t.Wm)(b,{caption:""},{default:(0,t.w5)((()=>[(0,t.Uk)(" 1 / "+(0,u.zw)(e.price),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])),[[o.F8,(0,n.SU)($).includes(String(e.have))]]))),128))])),_:1})])),_:1})])),_:1}),(0,t.Wm)(T,{name:"market",class:"no-padding"},{default:(0,t.w5)((()=>[(0,t._)("div",Ge,[(0,t.Wm)(B,{dense:"",outlined:"",rounded:"",modelValue:f.value,"onUpdate:modelValue":a[1]||(a[1]=e=>f.value=e),label:"Поиск"},{prepend:(0,t.w5)((()=>[(0,t.Wm)(c,{name:"search"})])),_:1},8,["modelValue"])]),(0,t.Wm)(r),(0,t.Wm)(L,{style:{height:"75vh"}},{default:(0,t.w5)((()=>[(0,t.Wm)(I,{separator:""},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(Object.keys(q.value).length>0?q.value:(0,n.SU)(O),((e,a)=>((0,t.wg)(),(0,t.j4)(D,{clickable:"",onClick:a=>(h.value=e,(0,n.SU)(p).toggleTradeModalVisible()),key:a},{default:(0,t.w5)((()=>[(0,t.Wm)(m,{class:"text-weight-medium"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(a.replace("_"," / ")),1)])),_:2},1024),(0,t.Wm)(m,{class:"text-caption"},{default:(0,t.w5)((()=>[(0,n.SU)(F).filter((e=>e.pair===a)).length>0?((0,t.wg)(),(0,t.iD)("span",Je,[Xe,ea,(0,t.Wm)(N,{rounded:"",color:"grey-3","text-color":"dark"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(parseFloat((0,n.SU)(F).find((e=>e.pair===a)).base_volume_24).toFixed(2))+" / "+(0,u.zw)(parseFloat((0,n.SU)(F).find((e=>e.pair===a)).quote_volume_24).toFixed(2)),1)])),_:2},1024),aa,la,ta,(0,t.Wm)(N,{rounded:"",color:"grey-3","text-color":"dark"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(parseFloat((0,n.SU)(F).find((e=>e.pair===a)).base_volume_1w).toFixed(2))+" / "+(0,u.zw)(parseFloat((0,n.SU)(F).find((e=>e.pair===a)).quote_volume_1w).toFixed(2)),1)])),_:2},1024),na,ua,oa,(0,t.Wm)(N,{rounded:"",color:"grey-3","text-color":"dark"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)(parseFloat((0,n.SU)(F).find((e=>e.pair===a)).base_volume_1m).toFixed(2))+" / "+(0,u.zw)(parseFloat((0,n.SU)(F).find((e=>e.pair===a)).quote_volume_1m).toFixed(2)),1)])),_:2},1024)])):(0,t.kq)("",!0)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})])),_:1}),(0,t.Wm)(T,{name:"own_orders",class:"no-padding"},{default:(0,t.w5)((()=>[(0,t.wy)(((0,t.wg)(),(0,t.j4)(s,{modelValue:x.value,"onUpdate:modelValue":a[2]||(a[2]=e=>x.value=e),align:"justify"},{default:(0,t.w5)((()=>[(0,t.Wm)(i,{"no-caps":"",class:"bg-white text-info",name:"active",label:"Активные"}),(0,t.Wm)(i,{"no-caps":"",class:"bg-white text-positive",name:"done",label:"Исполненные"}),(0,t.Wm)(i,{"no-caps":"",class:"bg-white text-negative",name:"cancel",label:"Отмененные"})])),_:1},8,["modelValue"])),[[le]]),(0,t.Wm)(r),(0,t.Wm)(L,{style:{height:"83vh"}},{default:(0,t.w5)((()=>[(0,t.Wm)(E,{modelValue:x.value,"onUpdate:modelValue":a[3]||(a[3]=e=>x.value=e),animated:""},{default:(0,t.w5)((()=>[(0,t.Wm)(T,{name:"active",class:"no-padding"},{default:(0,t.w5)((()=>[(0,t.Wm)(I,{separator:""},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(k.value,((e,a)=>((0,t.wg)(),(0,t.j4)(D,{key:a},{default:(0,t.w5)((()=>[(0,t.Wm)(m,null,{default:(0,t.w5)((()=>[(0,t._)("p",ia,(0,u.zw)((0,n.SU)(K).find((a=>a.key===e.wantAssetKey)).name)+" / "+(0,u.zw)((0,n.SU)(K).find((a=>a.key===e.haveAssetKey)).name),1),(0,t._)("p",sa,"Кол-во "+(0,u.zw)(e.amountHave),1),(0,t._)("p",ra,"Цена "+(0,u.zw)(e.price),1),(0,t._)("p",da,"Итого "+(0,u.zw)(e.amountWant),1),(0,t._)("p",ca,"Осталось "+(0,u.zw)(e.leftWant),1),(0,t._)("p",ma,[pa,(0,t._)("a",{target:"_blank",href:`https://scan.rupay.pro/index/blockexplorer.html?tx=${e.seqNo}&lang=ru`},(0,u.zw)(e.seqNo),9,va)])])),_:2},1024),(0,t.Wm)(m,null,{default:(0,t.w5)((()=>[(0,t.Wm)(M,{rounded:"",color:"negative",loading:g.value,onClick:a=>V(e.seqNo),unelevated:"",outline:"","no-caps":"",size:"12px",label:"Отменить оффер"},null,8,["loading","onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1}),(0,t.Wm)(T,{name:"done",class:"no-padding"},{default:(0,t.w5)((()=>[(0,t.Wm)(I,{separator:""},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(S.value,((e,a)=>((0,t.wg)(),(0,t.j4)(D,{key:a},{default:(0,t.w5)((()=>[(0,t.Wm)(m,null,{default:(0,t.w5)((()=>[(0,t._)("p",wa,(0,u.zw)((0,n.SU)(K).find((a=>a.key===e.wantAssetKey)).name)+" / "+(0,u.zw)((0,n.SU)(K).find((a=>a.key===e.haveAssetKey)).name),1),(0,t._)("p",ga,"Кол-во "+(0,u.zw)(e.amountHave),1),(0,t._)("p",_a,"Цена "+(0,u.zw)(e.price),1),(0,t._)("p",fa,"Итого "+(0,u.zw)(e.amountWant),1),(0,t._)("p",ya,"Осталось "+(0,u.zw)(e.leftWant),1),(0,t._)("p",xa,[Ua,(0,t._)("a",{target:"_blank",href:`https://scan.rupay.pro/index/blockexplorer.html?tx=${e.seqNo}&lang=ru`},(0,u.zw)(e.seqNo),9,ha)])])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1}),(0,t.Wm)(T,{name:"cancel",class:"no-padding"},{default:(0,t.w5)((()=>[(0,t.Wm)(I,{separator:""},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(W.value,((e,a)=>((0,t.wg)(),(0,t.j4)(D,{key:a},{default:(0,t.w5)((()=>[(0,t.Wm)(m,null,{default:(0,t.w5)((()=>[(0,t._)("p",ba,(0,u.zw)((0,n.SU)(K).find((a=>a.key===e.wantAssetKey)).name)+" / "+(0,u.zw)((0,n.SU)(K).find((a=>a.key===e.haveAssetKey)).name),1),(0,t._)("p",ka,"Кол-во "+(0,u.zw)(e.amountHave),1),(0,t._)("p",Sa,"Цена "+(0,u.zw)(e.price),1),(0,t._)("p",Wa,"Итого "+(0,u.zw)(e.amountWant),1),(0,t._)("p",qa,"Осталось "+(0,u.zw)(e.leftWant),1),(0,t._)("p",za,[Ha,(0,t._)("a",{target:"_blank",href:`https://scan.rupay.pro/index/blockexplorer.html?tx=${e.seqNo}&lang=ru`},(0,u.zw)(e.seqNo),9,Fa)])])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,t.Wm)(X,{modelValue:w.value,"onUpdate:modelValue":a[7]||(a[7]=e=>w.value=e),persistent:"","transition-show":"scale","transition-hide":"scale",onBeforeShow:P},{default:(0,t.w5)((()=>[(0,t.Wm)(J,{style:{width:"100%"}},{default:(0,t.w5)((()=>[(0,t.Wm)(R,{class:"bg-primary text-white"},{default:(0,t.w5)((()=>[(0,t._)("div",Va,[(0,t.Uk)("Обмен "+(0,u.zw)((0,n.SU)(K).find((e=>e.key===(0,n.SU)(A)[v.value].have)).name)+" ",1),(0,t.Wm)(c,{name:"las la-long-arrow-alt-right",size:"30px"}),(0,t.Uk)(" "+(0,u.zw)((0,n.SU)(K).find((e=>e.key===(0,n.SU)(A)[v.value].want)).name),1)])])),_:1}),(0,t.Wm)(R,null,{default:(0,t.w5)((()=>[(0,t._)("p",Qa,"Отдам "+(0,u.zw)((0,n.SU)(K).find((e=>e.key===(0,n.SU)(A)[v.value].have)).name)+" (баланс "+(0,u.zw)((0,n.SU)(Y)[(0,n.SU)(A)[v.value].have][0][1])+") ",1),(0,t.Wm)(B,{class:"q-mb-md",dense:"",outlined:"",autofocus:"",modelValue:_.value,"onUpdate:modelValue":a[5]||(a[5]=e=>_.value=e),onKeyup:Z,type:"number"},null,8,["modelValue"]),(0,t._)("p",Za,"Получу "+(0,u.zw)((0,n.SU)(K).find((e=>e.key===(0,n.SU)(A)[v.value].want)).name),1),(0,t.Wm)(B,{class:"q-mb-md",dense:"",outlined:"",modelValue:U.value,"onUpdate:modelValue":a[6]||(a[6]=e=>U.value=e),onKeyup:C,type:"number"},null,8,["modelValue"]),(0,n.SU)(z).raw?((0,t.wg)(),(0,t.iD)("p",Ca,"Комиссия : "+(0,u.zw)((0,n.SU)(z).fee),1)):(0,t.kq)("",!0)])),_:1}),(0,t.Wm)(G,{align:"right"},{default:(0,t.w5)((()=>[(0,t.wy)((0,t.Wm)(M,{"no-caps":"",unelevated:"",color:"negative",loading:g.value,outline:"",label:"Отмена"},null,8,["loading"]),[[te]]),(0,n.SU)(z).raw?((0,t.wg)(),(0,t.j4)(M,{key:1,"no-caps":"",unelevated:"",color:"positive",loading:g.value,onClick:Q,label:"Обменять"},null,8,["loading"])):((0,t.wg)(),(0,t.j4)(M,{key:0,"no-caps":"",unelevated:"",color:"positive",disable:!_.value||!U.value,loading:g.value,onClick:j,label:"Запросить комиссию"},null,8,["disable","loading"]))])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,t.Wm)((0,n.SU)(Be),{"trade-pair":h.value},null,8,["trade-pair"]),(0,t.Wm)(X,{modelValue:(0,n.SU)(H),"onUpdate:modelValue":a[8]||(a[8]=e=>(0,n.dq)(H)?H.value=e:H=e),persistent:"","transition-show":"scale","transition-hide":"scale"},{default:(0,t.w5)((()=>[(0,t.Wm)(J,{style:{width:"100%"}},{default:(0,t.w5)((()=>[(0,t.Wm)(R,{class:"bg-primary text-white"},{default:(0,t.w5)((()=>[Pa])),_:1}),(0,t.Wm)(R,null,{default:(0,t.w5)((()=>[(0,t.Wm)(I,{separator:"",dense:""},{default:(0,t.w5)((()=>[(0,t.Wm)(D,null,{default:(0,t.w5)((()=>[(0,t.Wm)(m,null,{default:(0,t.w5)((()=>[ja])),_:1}),(0,t.Wm)(m,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,u.zw)((0,n.SU)(z).fee),1)])),_:1})])),_:1})])),_:1})])),_:1}),(0,t.Wm)(G,{align:"right"},{default:(0,t.w5)((()=>[(0,t.wy)((0,t.Wm)(M,{"no-caps":"",unelevated:"",color:"grey-6",loading:g.value,label:"Отмена"},null,8,["loading"]),[[te]]),(0,t.Wm)(M,{"no-caps":"",unelevated:"",loading:g.value,onClick:Q,label:"Ок",color:"positive"},null,8,["loading"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1})}}});var Oa=l(47817),Da=l(70900),Ya=l(89800),$a=l(84106),Ia=l(66663),La=l(22857),Ta=l(33115),Ba=l(20990),Na=l(64871);const Ma=Aa,Ea=Ma;Le()(Aa,"components",{QTabs:Oa.Z,QTab:Da.Z,QSeparator:Ze.Z,QTabPanels:Ya.Z,QTabPanel:$a.Z,QScrollArea:Ia.Z,QList:Ae.Z,QItem:Oe.Z,QItemSection:De.Z,QAvatar:Ve.Z,QIcon:La.Z,QItemLabel:Ta.Z,QInput:Ce.Z,QBadge:Ba.Z,QBtn:Fe.Z,QDialog:qe.Z,QCard:ze.Z,QCardSection:Qe.Z,QCardActions:Ye.Z}),Le()(Aa,"directives",{TouchSwipe:Na.Z,ClosePopup:$e.Z})}}]);