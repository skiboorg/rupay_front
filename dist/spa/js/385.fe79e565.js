"use strict";(self["webpackChunkrupay_front"]=self["webpackChunkrupay_front"]||[]).push([[385],{75008:(e,a,t)=>{t.d(a,{C:()=>o,d:()=>n});var l=t(13433),s=t(17779);const n=({seed:e,password:a})=>{const t={status:!0,seed:e},s=l.createCipher("aes192",a);return s.update(JSON.stringify(t),"utf8","hex")+s.final("hex")},o=({hash:e,password:a})=>{try{const t=l.createDecipher("aes192",a),s=t.update(e,"hex","utf8")+t.final("utf8"),n=JSON.parse(s);return!!n.status&&n.seed}catch(t){return s.log(t),!1}}},14895:(e,a,t)=>{t.d(a,{Z:()=>h});var l=t(59835),s=t(60499),n=t(43463),o=t(87270),d=t(75008),u=t(17779);const i={props:["transactionInfo"]},r=Object.assign(i,{name:"PinCodeModal",emits:["pincode_ок"],setup(e,{emit:a}){const t=(0,n.s)();function i(e){const l=localStorage.getItem("hash"),s=(0,d.C)({hash:l,password:e});u.log(s),s?(a("pincode_ок"),t.togglePinCodeModalVisible()):(0,o.d)("negative","Неверный пинкод")}return(e,a)=>{const n=(0,l.up)("pin-code"),o=(0,l.up)("q-btn"),d=(0,l.up)("q-card-section"),u=(0,l.up)("q-card"),r=(0,l.up)("q-dialog");return(0,l.wg)(),(0,l.j4)(r,{modelValue:(0,s.SU)(t).pinCodeModalVisible,"onUpdate:modelValue":a[1]||(a[1]=e=>(0,s.SU)(t).pinCodeModalVisible=e),persistent:"",maximized:""},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{class:"bg-white fullscreen"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{class:"flex column items-center justify-center fullscreen"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{showDigits:!1,onPincode_ready:i}),(0,l.Wm)(o,{class:"q-mt-md",onClick:a[0]||(a[0]=e=>(0,s.SU)(t).togglePinCodeModalVisible()),"no-caps":"",color:"negative",label:"Отмена"})])),_:1})])),_:1})])),_:1},8,["modelValue"])}}});var c=t(32074),p=t(44458),m=t(63190),w=t(24455),g=t(69984),f=t.n(g);const v=r,h=v;f()(r,"components",{QDialog:c.Z,QCard:p.Z,QCardSection:m.Z,QBtn:w.Z})},38385:(e,a,t)=>{t.r(a),t.d(a,{default:()=>J});var l=t(59835),s=t(60499),n=t(86970),o=t(91569),d=t(14895),u=t(43463),i=t(87270),r=t(18910),c=t(98030),p=t(46190),m=t(23459),w=t(17779);const g=(0,l._)("div",{style:{height:"16px"}},null,-1),f={class:"text-weight-bold text-dark"},v={key:0,class:"text-weight-bold text-dark"},h={key:1,class:"text-weight-bold text-dark"},b=(0,l._)("p",{class:"text-negative text-center text-bold"},"У вас нет RUB баланса",-1),k=(0,l.Uk)(" Подтверждение отправки актива "),U=(0,l.Uk)("Актив"),_=(0,l.Uk)("RUB"),q=(0,l.Uk)("Количество"),x=(0,l.Uk)("Комиссия транзакции"),y={key:0},W={key:1},C={name:"SendRubToRolf",setup(e){const a=(0,u.s)(),{EraChain:C}=((0,r.tv)(),t(99407)),S=(0,p.c)(),Q=(0,m.Q)();let Z=(0,s.iH)(!1);const B=(0,s.iH)(!1);(0,s.iH)(0),(0,s.iH)(!1),(0,r.yj)();(0,s.iH)(null);const R=(0,l.Fl)((()=>S.balances)),V=(0,l.Fl)((()=>j.value.amount>0?.01*parseFloat(j.value.amount)<.25?.25:.01*parseFloat(j.value.amount):0)),D=(0,l.Fl)((()=>S.addresses[S.currentAddressIdx].address));function P(){a.togglePinCodeModalVisible()}const j=(0,s.iH)({amount:0,address:"7JXmTnbwuDnpqQ3NwxwzhfGgDk223j13eP",title:"Отправка RUB на РОЛФ",message:"Отправка RUB на РОЛФ",encrypted:!1,fee:0,raw:0});function z(){j.value={amount:0,address:"7JXmTnbwuDnpqQ3NwxwzhfGgDk223j13eP",title:"Отправка RUB на РОЛФ",message:"Отправка RUB на РОЛФ",encrypted:!1,fee:0,raw:0}}async function F(){B.value=!B.value;const e=!0,a=await Q.getKeyPair(),t=new C.Type.KeyPair(a),l={assetKey:"1643",amount:j.value.amount};w.log(t),w.log(l);const s=await c.era.tranRawSendAsset(t,l,j.value.address,j.value.title,j.value.message,j.value.encrypted,e);w.log(s),s.error?(0,i.d)("negative",s.error.message):(j.value.fee=s.fee,j.value.raw=s.raw),B.value=!B.value}async function H(){B.value=!B.value;const e=await o.h.get(`/api/user/check_address?wallet=${D.value}`);if(e.data.success){(0,i.d)("positive",e.data.message);const a=await c.era.broadcast64(j.value.raw);if(w.log(a),a.error)(0,i.d)("negative",a.message);else{(0,i.d)("info","Транзакция создана"),Z.value=!1;const e=await o.h.post("/api/user/rub_to_rolf",{wallet:D.value,tx:a.signature});e.data.success?((0,i.d)("positive",e.data.message),z()):(0,i.d)("negative",e.data.message)}}else(0,i.d)("negative",e.data.message);B.value=!B.value}return(e,a)=>{const t=(0,l.up)("page-header"),o=(0,l.up)("q-input"),u=(0,l.up)("btn"),i=(0,l.up)("q-card-section"),r=(0,l.up)("q-item-section"),c=(0,l.up)("q-item"),p=(0,l.up)("q-list"),m=(0,l.up)("q-btn"),w=(0,l.up)("q-card-actions"),C=(0,l.up)("q-card"),S=(0,l.up)("q-dialog"),Q=(0,l.up)("q-page"),D=(0,l.Q2)("close-popup");return(0,l.wg)(),(0,l.j4)(Q,null,{default:(0,l.w5)((()=>[(0,l.Wm)(t),g,(0,s.SU)(R)[1643]?((0,l.wg)(),(0,l.j4)(i,{key:0,class:"q-pt-none"},{default:(0,l.w5)((()=>[(0,l._)("p",f,"Ваш баланс: "+(0,n.zw)((0,s.SU)(R)[1643][0][1])+" RUB",1),(0,l.Wm)(o,{outlined:"",class:"q-mb-md",rounded:"",modelValue:j.value.amount,"onUpdate:modelValue":a[0]||(a[0]=e=>j.value.amount=e),label:"Укажите сумму перевода"},null,8,["modelValue"]),(0,s.SU)(V)>0?((0,l.wg)(),(0,l.iD)("p",v,"Комиссия за перевод: "+(0,n.zw)((0,s.SU)(V))+" RUB (1%, минимум: 0.25)",1)):(0,l.kq)("",!0),(0,s.SU)(V)>0?((0,l.wg)(),(0,l.iD)("p",h,"С вас спишется: "+(0,n.zw)(parseFloat(j.value.amount)+(0,s.SU)(V))+" RUB",1)):(0,l.kq)("",!0),(0,l.Wm)(u,{label:"Отправить",onClick:P,disabled:!j.value.amount||parseFloat(j.value.amount)+(0,s.SU)(V)>parseFloat((0,s.SU)(R)[1643][0][1]),outline:!1},null,8,["disabled"])])),_:1})):((0,l.wg)(),(0,l.j4)(i,{key:1,class:"q-pt-none"},{default:(0,l.w5)((()=>[b])),_:1})),(0,l.Wm)(S,{modelValue:(0,s.SU)(Z),"onUpdate:modelValue":a[1]||(a[1]=e=>(0,s.dq)(Z)?Z.value=e:Z=e),persistent:"","transition-show":"scale","transition-hide":"scale",onBeforeHide:z},{default:(0,l.w5)((()=>[(0,l.Wm)(C,{class:"bg-white text-dark",style:{width:"100%"}},{default:(0,l.w5)((()=>[(0,l.Wm)(i,{class:"text-weight-bold"},{default:(0,l.w5)((()=>[k])),_:1}),(0,l.Wm)(i,{class:"q-py-none"},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{dense:"",separator:"",class:"q-mb-md"},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{class:"no-padding"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{side:"",class:"text-weight-medium text-dark"},{default:(0,l.w5)((()=>[U])),_:1}),(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[_])),_:1})])),_:1}),(0,l.Wm)(c,{class:"no-padding"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{side:"",class:"text-weight-medium text-dark"},{default:(0,l.w5)((()=>[q])),_:1}),(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(j.value.amount)+" RUB",1)])),_:1})])),_:1}),(0,l.Wm)(c,{class:"no-padding"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{side:"",class:"text-weight-medium text-dark"},{default:(0,l.w5)((()=>[x])),_:1}),(0,l.Wm)(r,{class:"text-caption"},{default:(0,l.w5)((()=>[j.value.fee>0?((0,l.wg)(),(0,l.iD)("span",y,(0,n.zw)((0,s.SU)(V))+" RUB ",1)):(0,l.kq)("",!0),j.value.fee>0?((0,l.wg)(),(0,l.iD)("span",W,"+ газ "+(0,n.zw)(j.value.fee)+" OLF",1)):(0,l.kq)("",!0)])),_:1})])),_:1})])),_:1})])),_:1}),(0,l.Wm)(w,{class:"bg-white text-teal"},{default:(0,l.w5)((()=>[0===j.value.fee?((0,l.wg)(),(0,l.j4)(m,{key:0,label:"Расчет комиссии",rounded:"",loading:B.value,class:"q-mb-sm full-width",unelevated:"","no-caps":"",color:"info",onClick:F,outline:!1},null,8,["loading"])):((0,l.wg)(),(0,l.j4)(m,{key:1,label:"Подтвердить",rounded:"",loading:B.value,class:"q-mb-sm full-width",unelevated:"","no-caps":"",color:"positive",onClick:H,outline:!1},null,8,["loading"])),(0,l.wy)((0,l.Wm)(m,{label:"Отменить",rounded:"","no-caps":"",color:"negative",class:"full-width",unelevated:"",outline:"",loading:B.value},null,8,["loading"]),[[D]])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,l.Wm)((0,s.SU)(d.Z),{onPincode_ок:a[2]||(a[2]=e=>(0,s.dq)(Z)?Z.value=!0:Z=!0)})])),_:1})}}};var S=t(69885),Q=t(63190),Z=t(13119),B=t(32074),R=t(44458),V=t(13246),D=t(490),P=t(76749),j=t(11821),z=t(24455),F=t(62146),H=t(69984),I=t.n(H);const M=C,J=M;I()(C,"components",{QPage:S.Z,QCardSection:Q.Z,QInput:Z.Z,QDialog:B.Z,QCard:R.Z,QList:V.Z,QItem:D.Z,QItemSection:P.Z,QCardActions:j.Z,QBtn:z.Z}),I()(C,"directives",{ClosePopup:F.Z})}}]);